using System;
using System.Diagnostics;
using System.Net;
using System.Threading;
using RestSharp;
using RestSharp.Authenticators;

namespace Velosity_API_Demo
{
    /////////////////////////////////////////////////////////////////////////////////
    /////////////////////////////////////////////////////////////////////////////////
    /////////////////////////////////////////////////////////////////////////////////
    public partial class frmMain : Form
    {
        const string VelosityApiURL = "https://api.velosity.app/v1";
        const string APIKEY = ""; // Your APIKEY here

        /////////////////////////////////////////////////////////////////////////////////
        /////////////////////////////////////////////////////////////////////////////////
        /////////////////////////////////////////////////////////////////////////////////
        public frmMain()
        {
            InitializeComponent();
        }

        /////////////////////////////////////////////////////////////////////////////////
        /////////////////////////////////////////////////////////////////////////////////
        /////////////////////////////////////////////////////////////////////////////////
        private void frmMain_Load(object sender, EventArgs e)
        {
            GetPackingLists();
            GetSalesOrders();
        }

        /////////////////////////////////////////////////////////////////////////////////
        /////////////////////////////////////////////////////////////////////////////////
        /////////////////////////////////////////////////////////////////////////////////
        private List<PackingListModel> GetPackingLists()
        {
            var client = new RestClient(VelosityApiURL);
            var request = new RestRequest("/packinglists", Method.Get).AddHeader("APIKEY", APIKEY);

            var resp = client.Get<List<PackingListModel>>(request);
            if (resp == null) { return new List<PackingListModel>(); }

            return resp;
        }

        /////////////////////////////////////////////////////////////////////////////////
        /////////////////////////////////////////////////////////////////////////////////
        /////////////////////////////////////////////////////////////////////////////////
        private List<SalesOrderModel> GetSalesOrders()
        {
            var client = new RestClient(VelosityApiURL);
            var request = new RestRequest("/salesorders", Method.Get).AddHeader("APIKEY", APIKEY);

            var resp = client.Get<List<SalesOrderModel>>(request);
            if (resp == null) { return new List<SalesOrderModel>(); }

            return resp;
        }

    }
}